spring:
  application:
    name: trade-execution-module
  
  # Database Configuration
  data:
    mongodb:
      uri: mongodb://devina:devina4@172.31.12.118:27017/tradeIngestion?authSource=admin
  
  # Kafka Configuration
  kafka:
    bootstrap-servers: 172.31.12.118:9092
    consumer:
      group-id: kotsin-trade-execution-enhanced-30m-smart-aggregation-v4
      auto-offset-reset: earliest
      enable-auto-commit: false
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
      properties:
        spring.json.trusted.packages: "*"
        spring.json.value.default.type: java.util.HashMap
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer

# Server Configuration
server:
  port: 8080

# Application Configuration
app:
  trading:
    hours:
      nse:
        start: "09:15"
        end: "15:30"
      mcx:
        start: "09:00"
        end: "23:30"
      timezone: "Asia/Kolkata"
    risk:
      # Primary risk configuration - used across all modules
      default-risk-percentage: 1.5        # 1.5% default risk per trade
      max-risk-per-trade-percentage: 2.0   # 2% max risk per single trade
      max-portfolio-risk-percentage: 5.0   # 5% max total portfolio risk
      min-risk-reward-ratio: 1.5           # Minimum 1.5:1 risk-reward ratio
      
      # Position sizing configuration
      max-position-size: 5000              # Maximum units per position
      default-position-size: 1000          # Default position size fallback
      
      # Portfolio exposure limits
      max-portfolio-exposure: 8.0          # 8% max portfolio exposure
      max-daily-loss-percentage: 5.0       # 5% max daily loss limit
      
    targets:
      # Target multipliers based on risk amount
      target1-multiplier: 1.5              # Target 1 = Risk * 1.5
      target2-multiplier: 2.5              # Target 2 = Risk * 2.5  
      target3-multiplier: 4.0              # Target 3 = Risk * 4.0
      target4-multiplier: 6.0              # Target 4 = Risk * 6.0
      
    validation:
      # Price distance validation
      min-price-distance-percentage: 0.5   # 0.5% minimum price movement
      max-price-distance-percentage: 10.0  # 10% maximum price movement
      
    limits:
      # Trade limits
      max-active-trades: 10                # Maximum active trades
      max-trades-per-script: 2             # Maximum trades per script
      max-daily-trades: 20                 # Maximum trades per day
  
  portfolio:
    initial-capital: 100000  # 1 lakh initial capital as requested
    max-single-position: 10.0
    max-sector-exposure: 25.0
    max-drawdown-limit: 15.0
  
  diversification:
    max-simultaneous-trades: 2
    capital-split-percent: 45.0
    enable-fund-diversification: true

# Kafka Topics Configuration
kafka:
  topics:
    market-data: forwardtesting-data
    results:
      trade-results: trade-results
      daily-summary: daily-trade-summary
      profit-loss: profit-loss  # All entry/exit events
    signals: strategy-signals

# External API Configuration
company:
  mapping:
    api:
      base:
        url: http://13.126.14.119:8102

# Telegram Configuration
telegram:
  bot:
    token: 6110276523:AAFNH9wRYkQQymniK8ioE0EnmN_6pfUZkJk
  chat:
    id: -4640817596
  enabled: true
  
  # Separate Channels for Enhanced 30M
  alerts:
    chat:
      id: -4640817596
  execution:
    chat:
      id: -4987106706
  pnl:
    chat:
      id: -4924122957
  channels:
    enabled: true

# Logging Configuration
logging:
  level:
    com.kotsin.execution: INFO
    org.springframework.kafka.listener: WARN
    org.apache.kafka: WARN
    org.springframework.kafka: WARN
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,kafka
  endpoint:
    health:
      show-details: always

# Redis Configuration for indicator data
data:
  redis:
    host: localhost
    port: 6379
    timeout: 2000ms
    lettuce:
      pool:
        max-active: 8
        max-wait: -1ms
        max-idle: 8
        min-idle: 0

# CORS Configuration
cors:
  allowed-origins: "*"
  allowed-methods: "GET,POST,PUT,DELETE,OPTIONS"
  allowed-headers: "*"
  max-age: 3600

# Swagger/OpenAPI Configuration  
springdoc:
  swagger-ui:
    enabled: true
    path: /swagger-ui.html
    config-url: /v3/api-docs/swagger-config
    urls:
      - url: /v3/api-docs
        name: Trade Execution API
    operations-sorter: method
    tags-sorter: alpha
    show-extensions: true
    show-common-extensions: true
  api-docs:
    enabled: true
    path: /v3/api-docs
  show-actuator: false 